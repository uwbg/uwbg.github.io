function getFavorites(){const e=document.cookie.split("; ").find(e=>e.startsWith("favorites="));if(!e)return[];try{return JSON.parse(decodeURIComponent(e.split("=")[1]))}catch{return[]}}function saveFavorites(e){document.cookie=`favorites=${encodeURIComponent(JSON.stringify(e))}; path=/; max-age=31536000`,updateFavoritesBadge()}function updateFavoritesBadge(){const e=document.getElementById("favorites-badge");if(!e)return;const t=getFavorites().length;t>0?(e.textContent=t,e.style.display="flex"):e.style.display="none"}function getCurrentGamePath(){return"/"+window.location.pathname.split("/").filter(Boolean).slice(-2).join("/")}function createFavoritesDrawer(){let e=document.getElementById("favoritesDrawer");if(e)return e;e=document.createElement("div"),e.id="favoritesDrawer",e.className="favorites-drawer hidden";const t=document.createElement("h3");t.className="favorites-drawer-title",t.innerHTML="ðŸ’– Favorites";const n=document.createElement("div");n.className="favorites-list-container";const r=document.createElement("div");return r.id="favoritesList",r.className="recent-games-grid",n.appendChild(r),e.appendChild(t),e.appendChild(n),document.body.appendChild(e),renderFavoritesList(),e}function toggleFavoritesDrawer(e){e&&e.stopPropagation();const t=createFavoritesDrawer();if(!t.classList.contains("hidden"))t.classList.add("hidden");else{"function"==typeof window.closeAllDrawers&&window.closeAllDrawers();const e=document.getElementById("recentGamesDrawer");e&&e.classList.add("hidden");const n=document.getElementById("online-users-dropdown");n&&(n.style.display="none");const r=document.getElementById("server-dropdown");r&&(r.style.display="none"),t.classList.remove("hidden"),renderFavoritesList(),updateFavoritesBadge()}}document.addEventListener("click",e=>{const t=document.getElementById("favoritesDrawer"),n=document.getElementById("favoriteDrawerBtn");!t||t.classList.contains("hidden")||t.contains(e.target)||n.contains(e.target)||t.classList.add("hidden")});let currentFetchController=null;function renderFavoritesList(){const e=document.getElementById("favoritesList");if(!e)return;currentFetchController&&currentFetchController.abort(),e.innerHTML="";const t=getFavorites();0!==t.length?(currentFetchController=new AbortController,fetch("/data-json/games.json",{signal:currentFetchController.signal}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(n=>{e.parentNode&&(t.forEach(t=>{const r=t.split("/").pop().replace(".html",""),a=n.find(e=>e.slug===r);a?createGameCard(a,e):createFallbackCard(t,e)}),currentFetchController=null)}).catch(n=>{"AbortError"!==n.name&&(console.error("Oyun verileri yÃ¼klenirken hata oluÅŸtu:",n),t.forEach(t=>{createFallbackCard(t,e)}),currentFetchController=null)})):e.innerHTML='\n          <div class="favorites-empty-state">\n            \n            <div style="color: #a0aec0; font-size: 14px;">-</div>\n          </div>\n        '}function createGameCard(e,t){const n=document.createElement("div");n.className="recent-game-card",n.innerHTML=`\n    <a href="${e.url}" class="recent-game-link">\n      <div class="recent-game-image-container">\n        <img src="${e.image}" alt="${e.title}" class="recent-game-image" \n             onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\\'recent-game-placeholder\\'>ðŸŽ®</div>'">\n      </div>\n      <div class="recent-game-info">\n        <div class="recent-game-title">${e.title}</div>\n      </div>\n    </a>\n  `,t.appendChild(n)}function createFallbackCard(e,t){const n=document.createElement("div");n.className="recent-game-card";const r=e.split("/").pop().replace(".html","").replace(/-/g," ");n.innerHTML=`\n    <a href="${e}" class="recent-game-link">\n      <div class="recent-game-image-container">\n        <div class="recent-game-placeholder">ðŸŽ®</div>\n      </div>\n      <div class="recent-game-info">\n        <div class="recent-game-title">${r}</div>\n      </div>\n    </a>\n  `,t.appendChild(n)}function updateFavoriteIcons(e){const t=document.getElementById("favoriteNavIcon"),n=document.getElementById("favoriteIcon");t&&t.setAttribute("fill",e?"hotpink":"gray"),n&&n.setAttribute("fill",e?"hotpink":"gray")}function toggleFavorite(){const e=getCurrentGamePath();let t=getFavorites();const n=t.indexOf(e);-1===n?(t.push(e),updateFavoriteIcons(!0)):(t.splice(n,1),updateFavoriteIcons(!1)),saveFavorites(t),renderFavoritesList()}document.addEventListener("DOMContentLoaded",()=>{const e=getCurrentGamePath();updateFavoriteIcons(getFavorites().includes(e)),updateFavoritesBadge(),"function"==typeof crayzgames&&setTimeout(()=>crayzgames(),2e3*Math.random())});