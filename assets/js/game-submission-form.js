window.gameFormLoadTime=(new Date).toISOString(),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("gameSubmissionForm"),t=document.getElementById("submitButton"),n=document.getElementById("submitButtonText"),r=document.getElementById("submitButtonSpinner"),o=document.getElementById("responseMessage"),s=document.getElementById("serverLinksContainer"),i=document.getElementById("shortDescription"),a=document.getElementById("shortDescCount");function showMessage(e,t){o.textContent=e,o.style.display="block","success"===t?(o.style.backgroundColor="rgba(28, 189, 100, 0.1)",o.style.border="1px solid rgba(28, 189, 100, 0.3)",o.style.color="var(--bs-success)"):(o.style.backgroundColor="rgba(223, 50, 92, 0.1)",o.style.border="1px solid rgba(223, 50, 92, 0.3)",o.style.color="var(--bs-danger)"),o.scrollIntoView({behavior:"smooth",block:"nearest"})}t.disabled=!0,setTimeout(()=>{t.disabled=!1},5e3),i.addEventListener("input",function(){a.textContent=this.value.length}),s.addEventListener("click",function(e){if(e.target.classList.contains("add-server-link")){const e=document.createElement("div");e.className="server-link-item mb-2",e.style.cssText="display: flex; gap: 10px; align-items: center;",e.innerHTML='\n        <input \n          type="url" \n          class="form-control server-link-input" \n          name="serverLinks[]" \n          placeholder="https://example.com/game"\n          required\n          style="padding: 12px; border-radius: 8px; border: 1px solid var(--bs-gray-400); flex: 1; background-color: #073858; color: white;"\n        />\n        <button \n          type="button" \n          class="btn btn-danger remove-server-link" \n          style="padding: 12px 20px; border-radius: 8px; background-color: var(--bs-danger); border: none; color: white; font-weight: 600; cursor: pointer; min-width: 45px;"\n        >\n          âˆ’\n        </button>\n      ',s.appendChild(e)}else e.target.classList.contains("remove-server-link")&&e.target.closest(".server-link-item").remove()}),e.addEventListener("submit",function(i){if(i.preventDefault(),!e.checkValidity())return void e.reportValidity();const l=document.querySelectorAll(".server-link-input"),d=Array.from(l).map(e=>e.value.trim()).filter(e=>""!==e);if(0===d.length)return void showMessage("Please add at least one server link.","error");const m={userName:document.getElementById("userName").value.trim(),userEmail:document.getElementById("userEmail").value.trim(),gameName:document.getElementById("gameName").value.trim(),categories:document.getElementById("categories").value.trim().split(",").map(e=>e.trim()),tags:document.getElementById("tags").value.trim().split(",").map(e=>e.trim()),images:document.getElementById("images").value.trim().split(",").map(e=>e.trim()),shortDescription:document.getElementById("shortDescription").value.trim(),longDescription:document.getElementById("longDescription").value.trim(),howToPlay:document.getElementById("howToPlay").value.trim(),serverLinks:d,formLoadTime:window.gameFormLoadTime||(new Date).toISOString(),website:""};t.disabled=!0,n.style.display="none",r.style.display="inline-block",o.style.display="none";fetch("https://user.ucbg.online/contact-api/submit-game.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(t=>{showMessage(t.message||"Game submitted successfully! We will review your submission and get back to you soon.","success"),e.reset(),a.textContent="0",s.innerHTML='\n          <div class="server-link-item mb-2" style="display: flex; gap: 10px; align-items: center;">\n            <input \n              type="url" \n              class="form-control server-link-input" \n              name="serverLinks[]" \n              placeholder="https://example.com/game"\n              required\n              style="padding: 12px; border-radius: 8px; border: 1px solid var(--bs-gray-400); flex: 1; background-color: #073858; color: white;"\n            />\n            <button \n              type="button" \n              class="btn btn-success add-server-link" \n              style="padding: 12px 20px; border-radius: 8px; background-color: var(--bs-success); border: none; color: white; font-weight: 600; cursor: pointer; min-width: 45px;"\n            >\n              +\n            </button>\n          </div>\n        '}).catch(e=>{console.error("Error:",e),e.message&&e.message.includes("429")?showMessage("You've submitted too many games. Please wait before trying again.","error"):showMessage("An error occurred while submitting your game. Please try again later or contact us directly at cricoverteam@gmail.com","error")}).finally(()=>{t.disabled=!1,n.style.display="inline-block",r.style.display="none"})})});