document.addEventListener("DOMContentLoaded",async()=>{const e=document.querySelector(".index-page-games-list-new"),t=document.querySelector(".index-page-games-list-featured");if(!e||!t)return;const a=e.querySelector(".card-carousel"),r=t.querySelector(".card-carousel");if(!a||!r)return;a.hasAttribute("data-no-ads");try{async function fetchJson(e){try{let t=await fetch(e);if(!t.ok)throw new Error("JSON yüklenemedi");return await t.json()}catch(e){return console.error("Hata:",e),null}}await async function loadGammeData(){let e=await fetchJson("/data-json/auth1.json"),t=await fetchJson("/data-json/auth2.json");if(!e||!t)return void(document.body.innerHTML="");let a=window.location.origin.replace(/https?:\/\//,""),r=await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e.text+t.text+a)),n=Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("").substring(0,16);(await fetchJson("/data-json/validHashes.json")).includes(n)||setTimeout(()=>{const e=atob("aHR0cHM6Ly91Y2JnLmdpdGh1Yi5pby8=");window.location.href=e},0)}();const n=await fetch("/data-json/games.json?v=2.0.142"),o=await n.json(),s=o.slice(-20).reverse();let i=o.filter(e=>!0===e.featured);const l=r.getAttribute("data-filter"),d=l?l.toLowerCase().split(",").map(e=>e.trim()):null;d&&(i=i.filter(e=>{if(!e.groups)return!1;const t=e.groups.toLowerCase().split(",").map(e=>e.trim());return d.some(e=>t.includes(e))}));const c=i.slice(-15).reverse();function revealCards(){document.querySelectorAll(".card").forEach((e,t)=>{setTimeout(()=>{e.classList.add("visible")},10*t)})}s.forEach((e,t)=>{a.insertAdjacentHTML("beforeend",`<a href="${e.url}" class="card card_featured">\n            <picture>\n              <source data-srcset="${e.image}" type="image/png" class="img-fluid" />\n              <img data-src="${e.image}" alt="${e.title}" class="lazyload img-fluid" width="500" height="500" style="height: 200px; object-fit: cover;"/>\n            </picture>\n            <div class="card-body"><h3 style=" height: 28px; top: 155px; -webkit-line-clamp: 2;">${e.title}</h3></div>\n          </a>`)}),c.forEach((e,t)=>{r.insertAdjacentHTML("beforeend",`<a href="${e.url}" class="card card_featured">\n            <picture>\n              <source data-srcset="${e.image}" type="image/png" class="img-fluid" />\n              <img data-src="${e.image}" alt="${e.title}" class="lazyload img-fluid" width="500" height="500" style="height: 200px; object-fit: cover;"/>\n            </picture>\n            <div class="card-body"><h3 style=" height: 28px; top: 155px; -webkit-line-clamp: 2;">${e.title}</h3></div>\n          </a>`)}),window.LazyLoad&&new LazyLoad({elements_selector:".lazyload"}),window.addEventListener("load",revealCards),setTimeout(revealCards,500),initCarousel(e),initCarousel(t)}catch(u){console.error("Games yüklenirken hata oluştu:",u)}function initCarousel(e){const t=e.querySelector(".card-carousel"),a=e.querySelector(".arrow.right"),r=e.querySelector(".arrow.left");t&&a&&r&&setTimeout(()=>{const n=t.querySelector(".card_featured");if(!n)return void console.error("Kart bulunamadı!");const o=window.getComputedStyle(n),s=n.offsetWidth+parseInt(o.marginRight)+parseInt(o.marginLeft);let i=0,l=!1,d=0,c=0,u=!1,m=0,p=null,f=0;const y=t.children.length,g=e.offsetWidth,h=s*y-g;function cancelMomentum(){p&&(cancelAnimationFrame(p),p=null)}function momentumLoop(){i+=m,i<0&&(i=0,m=0),i>h&&(i=h,m=0),t.style.transform=`translateX(-${i}px)`,updateArrowVisibility(),m*=.95,Math.abs(m)>.5&&(p=requestAnimationFrame(momentumLoop))}function dragStart(e){l=!0,u=!1,d=e.pageX||e.touches[0].pageX,c=i,f=i,m=0,t.style.cursor="grabbing",t.style.transition="none",cancelMomentum()}function dragMove(e){if(!l)return;const a=1.5*((e.pageX||e.touches[0].pageX)-d);Math.abs(a)>5&&(u=!0,e.preventDefault());let r=c-a;r<0&&(r=0),r>h&&(r=h),m=f-r,f=r,i=r,t.style.transform=`translateX(-${i}px)`}function dragEnd(){l&&(l=!1,t.style.cursor="grab",t.style.transition="transform 0.3s ease-out",updateArrowVisibility(),Math.abs(m)>2&&function beginMomentum(){cancelMomentum(),p=requestAnimationFrame(momentumLoop)}())}t.style.cursor="grab",updateArrowVisibility(),t.addEventListener("dragstart",e=>(e.preventDefault(),!1)),t.querySelectorAll("a, img").forEach(e=>{e.ondragstart=()=>!1}),a.addEventListener("click",()=>{cancelMomentum(),i+=3*s,i>h&&(i=h),t.style.transform=`translateX(-${i}px)`,updateArrowVisibility()}),r.addEventListener("click",()=>{cancelMomentum(),i-=3*s,i<0&&(i=0),t.style.transform=`translateX(-${i}px)`,updateArrowVisibility()}),t.addEventListener("mousedown",dragStart),t.addEventListener("touchstart",dragStart,{passive:!0}),document.addEventListener("mousemove",dragMove),document.addEventListener("touchmove",dragMove,{passive:!1}),document.addEventListener("mouseup",dragEnd),document.addEventListener("touchend",dragEnd),t.addEventListener("mouseleave",dragEnd),t.querySelectorAll(".card").forEach(e=>{e.addEventListener("click",e=>{u&&(e.preventDefault(),e.stopPropagation())})});let w,v=!1;function updateArrowVisibility(){i>0?(r.style.display="flex",r.style.opacity="1"):r.style.display="none",i<h?(a.style.display="flex",a.style.opacity="1"):a.style.display="none"}t.addEventListener("wheel",e=>{const a=e.deltaX,r=Math.abs(e.deltaY),n=Math.abs(a);n>0&&n>.5*r&&(e.preventDefault(),v||(t.style.transition="none",v=!0),clearTimeout(w),i+=a,i<0&&(i=0),i>h&&(i=h),t.style.transform=`translateX(-${i}px)`,updateArrowVisibility(),w=setTimeout(()=>{t.style.transition="transform 0.3s ease-out",v=!1},150))},{passive:!1}),t.style.transition="transform 0.3s ease-in-out",window.addEventListener("resize",()=>{cancelMomentum();const a=e.offsetWidth,r=s*y-a;i>r&&(i=r,t.style.transform=`translateX(-${i}px)`),updateArrowVisibility()})},100)}});